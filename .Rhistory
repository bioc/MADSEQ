EB11_AAF = prepareHetero(EB11_vcf,bed,writeToFile = F)
EB11_AAF
EB11_chr18 = runMadSeq(EB11_AAF,norm[[2]],"chr18")
EB7_cov
EB11_cov
norm[[1]]
norm[[2]]
x = as.data.frame(norm[[1]])
y = as.data.frame(norm[[2]])
EB7_chr18 = x[x$seqnames=="chr18",]
EB11_chr18 = y[y$seqnames=="chr18",]
sum(EB11_chr18$normed_depth>EB7_chr18$normed_depth)
EB11_chr18
x = which(EB11_chr18$start==EB7_chr18$start)
x=match(EB7_chr18$start,EB11_chr18$start)
x
which(is.na(x))
EB7_chr18[122,]
EB11_chr18$start==73436201
sum(EB11_chr18$start==73436201)
EB7_chr18 = EB7_chr18[-122,]
x=match(EB7_chr18$start,EB11_chr18$start)
x
EB11_chr18 = EB11_chr18[x,]
sum(EB11_chr18$normed_depth>EB7_chr18$normed_depth)
x = EB11_chr18[EB11_chr18$normed_depth>EB7_chr18$normed_depth,]
y = EB7_chr18[EB11_chr18$normed_depth>EB7_chr18$normed_depth,]
all(x$start==y$start)
summary(x)
summary(y)
38/28
head(x)
write.table(x[,1:3], "/Volumes/home/ykong/Aneuploidy/EB7_EB12/bam/tmp.bed",sep="\t",quote = F,row.names = F,col.names = F)
EB7_cov = prepareCoverageGC(bed,EB7_bam)
EB11_cov = prepareCoverageGC(bed,EB11_bam)
norm = normalizeCoverage(EB11_cov,control=EB7_cov,writeToFile = F)
EB11_chr18 = runMadSeq(EB11_AAF,norm[[2]],"chr18")
EB11_AAF = prepareHetero(EB11_vcf,bed,writeToFile = F)
EB11_AAF
EB11_chr18 = runMadSeq(EB11_AAF,norm[[2]],"chr18")
EB11_vcf
EB11_AAF = prepareHetero(EB11_vcf,bed,writeToFile = F)
EB11_AAF
EB11_chr18 = runMadSeq(EB11_AAF,norm[[2]],"chr18")
EB11_chr18
plotMadSeq(EB11_chr18)
plotFraction(EB11_chr18)
plotMixture(EB11_chr18)
library(MADSEQ)
plotFraction(EB11_chr18)
library(MADSEQ)
plotFraction(EB11_chr18)
library(MADSEQ)
a = system.file("extadata","aneuploidy.bam",package="MADSEQ")
a
a
a = system.file("extdata","aneuploidy.bam",package="MADSEQ")
a
EB11_chr17 = runMadSeq(EB11_AAF,norm[[2]],"chr17")
library(MADSEQ)
EB11_chr17 = runMadSeq(EB11_AAF,norm[[2]],"chr17")
EB11_chr17
plotMadSeq(EB11_chr17)
plotMixture(EB11_chr17)
plotFraction(EB11_chr17)
library(MADSEQ)
plotFraction(EB11_chr17)
source("https://bioconductor.org/biocLite.R")
biocLite("SMITE")
library(SMITE)
library("SMITE")
biocLite("SMITE")
devtools::document()
?prepareCoverageGC
devtools::document()
devtools::document()
devtools::document()
?prepareCoverageGC
devtools::document()
?prepareCoverageGC
?MadSeq
devtools::document()
?prepareCoverageGC
?plot
devtools::document()
?prepareCoverageGC
?Granges
?GRanges
devtools::document()
?prepareCoverageGC
?prepareCoverageGC
devtools::document()
?prepareCoverageGC
devtools::document()
?normalizeCoverage
devtools::document()
?normalizeCoverage
system.file("extdata","aneuploidy.vcf.gz","MADSEQ")
system.file("extdata","aneuploidy.vcf.gz","MADSEQ")
system.file("extdata","aneuploidy.vcf.gz",package="MADSEQ")
devtools::document()
?prepareHetero
devtools::document()
?prepareHetero
options(stringsAsFactors=F)
pop = read.table("pop.txt",sep="\t",header=F)[,1]
setwd("/Volumes/data/Project/Aneuploidy/MADSEQ")
pop = read.table("pop.txt",sep="\t",header=F)[,1]
setwd("/Volumes/data/Project/Aneuploidy/Loci_1000g/pop")
pop = read.table("pop.txt",sep="\t",header=F)[,1]
CLM = read.table("CLM.geno.012",sep="\t",header=F)
CLM = t(CLM)
CLM = CLM[-1,]
CLM = CLM[1:103246,]
CLM[1:10,]
CLM[1:10,1:10]
indiv1 = CLM[,1]
pos = read.table("ESN.geno.012.pos",sep="\t",header=F)
head(pos)
pos = pos[1:103246,]
tail(pos)
indiv1 = cbind(pos,indiv1)
head(indiv1)
test = indiv1[indiv1[,3]==1,]
head(test)
plot(test[test[,1]==1,2],runif(length(test[test[,1]==1,2])),pch=20)
library(MADSEQ)
library(MADSEQ)
?prepareCoverageGC
devtools::document()
?prepareCoverageGC
devtools::document()
devtools::document()
?runMadSeq
devtools::document()
?runMadSeq
devtools::document()
?runMadSeq
devtools::document()
?rjags
?"MADSEQ-package"
cite("rjags")
cite(rjags)
?citation
citation("rjags")
devtools::document()
?runMadSeq
?rjags
devtools::document()
?MADSEQ
devtools::document()
?"MadSeq"
?prepareHetero
require("BiocGenerics")
library(MADSEQ)
devtools::document()
library(MADSEQ)
?normalizeCoverage
library(MADSEQ)
library(MADSEQ)
library(MADSEQ)
?GRangesList
?length
?GRanges
?ScanBamParam
?coverage
?readGAlignments
?alphabetFrequency
?"BiocGenerics"
devtools::document()
devtools::document()
library(MADSEQ)
?prepareHetero
?runMadSeq
?library
?suppressMessages
?options
getwd()
?runMadSeq
library(MADSEQ)
library(MADSEQ)
devtools::document()
devtools::install_deps(dependencies = TRUE)
?deltaBIC
?prepareCoverageGC
library(MADSEQ)
?prepareCoverageGC
?deltaBIC
library(MADSEQ)
?methods
library("methods")
?methods
?`methods-package`
devtools::document()
devtools::document()
?MadSeq
?"MADSEQ-package"
devtools::document()
?"MADSEQ"
library(MADSEQ)
devtools::document()
?summary-method
?summary
library(MADSEQ)
library(MADSEQ)
?summary
?summary
devtools::document()
library(MADSEQ)
bam1 = system.file("extdata","aneuploidy.bam",package="MADSEQ")
bam2 = system.file("extdata","normal.bam",package="MADSEQ")
target = system.file("extdata","target.bed",package="MADSEQ")
vcf1 = system.file("extdata","aneuploidy.vcf",package="MADSEQ")
vcf1 = system.file("extdata","aneuploidy.vcf.gz",package="MADSEQ")
aneuploidy_cov = prepareCoverageGC(target,bam1)
normal_cov = prepareCoverageGC(target,bam2)
normalizeCoverage(aneuploidy_cov,control=normal_cov,destination = "inst/extdata/")
prepareHetero(vcf1,target,destination = "inst/extdata/")
?prepareGenomeplot
?prepareGenomePlot
?quantsmooth
require("quantsmooth")
?quantsmooth
devtools::document()
library(MADSEQ)
?runMadSeq
aneuploidy_bam = system.file("extdata","aneuploidy.bam",package="MADSEQ")
normal_bam = system.file("extdata","normal.bam",package="MADSEQ")
aneuploidy_cov_gc = prepareCoverageGC(target,aneuploidy_bam,"hg19")
target = system.file("extdata","target.bed",package="MADSEQ")
aneuploidy_cov_gc = prepareCoverageGC(target,aneuploidy_bam,"hg19")
normal_cov_gc = prepareCoverageGC(target,normal_bam,"hg19")
normed = normalizeCoverage(aneuploidy_cov_gc,
#'                            control=normal_cov_gc,writeToFile=FALSE)
)
normed = normalizeCoverage(aneuploidy_cov_gc,control=normal_cov_gc,writeToFile=FALSE)
normed
names(normed)
aneuploidy_normed_cov = normed[["aneuploidy_cov_gc"]]
aneuploidy_chr18 = runMadSeq(aneuploidy_hetero, aneuploidy_normed_cov,target_chr="chr18")
aneuploidy_vcf = system.file("extdata","aneuploidy.vcf.gz",package="MADSEQ")
aneuploidy_hetero = prepareHetero(aneuploidy_vcf, target, writeToFile=FALSE)
aneuploidy_chr18 = runMadSeq(aneuploidy_hetero, aneuploidy_normed_cov,target_chr="chr18")
target = "../tmp/tmp_target.bed"
aneuploidy_cov = prepareCoverageGC(target,aneuploidy_bam)
normal_cov = prepareCoverageGC(target,normal_bam)
normed = normalizeCoverage(aneuploidy_cov,control=normal_cov)
aneuploidy_vcf = "../tmp/tmp_aneuploidy.vcf.gz"
aneuploidy_hetero = prepareHetero(aneuploidy_vcf,target,"hg19",writeToFile = F)
aneuploidy_hetero
res = runMadSeq(aneuploidy_hetero,normed[["aneuploidy_cov"]])
res = runMadSeq(aneuploidy_hetero,normed[["aneuploidy_cov"]],"chr18")
normed = normalizeCoverage(aneuploidy_cov,control=normal_cov,writeToFile = F)
res = runMadSeq(aneuploidy_hetero,normed[["aneuploidy_cov"]],"chr18")
?"runMadSeq"
res = runMadSeq(aneuploidy_hetero,normed[["aneuploidy_cov"]],"chr18",nChain=1)
aneuploidy_vcf = system.file("extdata","aneuploidy.vcf.gz",package="MADSEQ")
target = system.file("extdata","target.bed",package="MADSEQ")
aneuploidy_hetero = prepareHetero(aneuploidy_vcf, target, writeToFile=FALSE)
aneuploidy_bam = system.file("extdata","aneuploidy.bam",package="MADSEQ")
normal_bam = system.file("extdata","normal.bam",package="MADSEQ")
aneuploidy_cov_gc = prepareCoverageGC(target,aneuploidy_bam,"hg19")
normal_cov_gc = prepareCoverageGC(target,normal_bam,"hg19")
normed = normalizeCoverage(aneuploidy_cov_gc,
control=normal_cov_gc,writeToFile=FALSE)
aneuploidy_normed_cov = normed[["aneuploidy_cov_gc"]]
#' ## check chromosome18
aneuploidy_chr18 = runMadSeq(aneuploidy_hetero, aneuploidy_normed_cov,
target_chr="chr18",nChain =1)
target = system.file("extdata","target.bed",package="MADSEQ")
bam1 = "../tmp/aneuploidy1.bam"
bam2 = "../tmp/normal1.bam"
aneuploidy_vcf = "../tmp/tmp_aneuploidy.vcf.gz"
aneuploidy_cov = prepareCoverageGC(target,bam1)
normal_cov = prepareCoverageGC(target,bam2)
normed = normalizeCoverage(aneuploidy_cov,control=normal_cov,writeToFile = F)
aneuploidy_AAF = prepareHetero(aneuploidy_vcf,target,writeToFile = F)
aneuploidy_AAF = prepareHetero(aneuploidy_vcf,target,writeToFile = F)
res = runMadSeq(aneuploidy_AAF,normed[["aneuploidy_cov"]],nChain = 1)
res = runMadSeq(aneuploidy_AAF,normed[["aneuploidy_cov"]],nChain = 1,target_chr = "chr18")
res = runMadSeq(aneuploidy_AAF,normed[["aneuploidy_cov"]],nChain = 1,target_chr = "chr18",nStep = 5000,thinSteps=1)
res
res = runMadSeq(aneuploidy_AAF,normed[["aneuploidy_cov"]],nChain = 1,target_chr = "chr18",nStep = 5000,thinSteps=1,adapt=5000)
res
res = runMadSeq(aneuploidy_AAF,normed[["aneuploidy_cov"]],nChain = 1,target_chr = "chr18",nStep = 5000,thinSteps=1,adapt=5000,burnin=5000)
devtools::document()
library(MADSEQ)
curve(dbeta(x,1,1))
curve(dbeta(x,2,1))
curve(dbeta(x,2,2))
?dbeta
curve(dbeta(x=seq(0,1,0.01),2,2))
?curve
curve(x^3 - 3*x, -2, 2)
x=seq(0,1,0.01)
curve(x^3 - 3*x, -2, 2)
curve(dbeta(x=seq(0,1,0.01),2,2))
curve(dbeta(x,2,2))
x=seq(0,2,0.01)
curve(dbeta(x,2,2))
library(MADSEQ)
devtools::document()
devtools::document()
library(MADSEQ)
devtools::document()
devtools::document()
library(MADSEQ)
install.packages("rmarkdown")
install.packages("rmarkdown")
library(MADSEQ)
sys.which("pdflatex")
Sys.which("pdflatex")
?vignetteEngine
?knitr
?"textConnection-class"\
?texi2dvi
source("https://bioconductor.org/biocLite.R")
biocLite("BiocCheck")
library("BiocCheck")
?summary
aneuploidy_vcf = system.file("extdata","aneuploidy.vcf.gz",package="MADSEQ")
target = system.file("extdata","target.bed",package="MADSEQ")
aneuploidy_hetero = prepareHetero(aneuploidy_vcf, target, writeToFile=FALSE)
aneuploidy_bam = system.file("extdata","aneuploidy.bam",package="MADSEQ")
normal_bam = system.file("extdata","normal.bam",package="MADSEQ")
aneuploidy_cov_gc = prepareCoverageGC(target,aneuploidy_bam,"hg19")
normal_cov_gc = prepareCoverageGC(target,normal_bam,"hg19")
normed = normalizeCoverage(aneuploidy_cov_gc,
control=normal_cov_gc,writeToFile=FALSE)
aneuploidy_normed_cov = normed[["aneuploidy_cov_gc"]]
aneuploidy_chr18 = runMadSeq(aneuploidy_hetero, aneuploidy_normed_cov,
target_chr="chr18")
summary(aneuploidy_chr18)
save(aneuploidy_chr18,file="./data/aneuploidy_chr18.RData")
data("aneuploidy_chr18")
data("aneuploidy_chr18")
devtools::document()
devtools::document()
?aneuploidy_chr18
devtools::document()
devtools::document()
?aneuploidy_chr18
devtools::document()
?aneuploidy_chr18
devtools::document()
library(MADSEQ)
?predict
devtools::document()
?par
devtools::document()
warnings()
warnings()
warnings()
warnings()
devtools::document()
devtools::document()
?stats
?loess
?"BiocGenerics"
devtools::document()
library(MADSEQ)
devtools::document()
library(MADSEQ)
devtools::document()
devtools::document()
?rowRanges
??rowRanges
require("VariantAnnotation")
?"rowRanges"
?VariantAnnotation
?readVcf
version()
library(VariantAnnotation)
fl <- system.file("extdata", "chr22.vcf.gz", package="VariantAnnotation")
vcf <- readVcf(fl, "hg19")
vcf
rowRanges(vcf)
?"rowRanges"
GenomicRanges::rowRanges(vcf)
info(vcf)
?geno
?"rowRanges"
?"rowRanges,VCF-method"
?"rowRanges"
devtools::document()
SummarizedExperiment::rowRanges(vcf)
?par
?elementLengths
?GRangesList
gr1 <-
GRanges(seqnames = "chr2", ranges = IRanges(3, 6),
strand = "+", score = 5L, GC = 0.45)
gr2 <-
GRanges(seqnames = c("chr1", "chr1"),
ranges = IRanges(c(7,13), width = 3),
strand = c("+", "-"), score = 3:4, GC = c(0.3, 0.5))
gr3 <-
GRanges(seqnames = c("chr1", "chr2"),
ranges = IRanges(c(1, 4), c(3, 9)),
strand = c("-", "-"), score = c(6L, 2L), GC = c(0.4, 0.1))
grl <- GRangesList("gr1" = gr1, "gr2" = gr2, "gr3" = gr3)
grl
length(grl)
elementLengths(grl)
lapply(grl,length)
sapply(grl,length)
?"sapply"
unique(sapply(grl,length))
?par
?colors
?axis
?lines
?legend
?loess
?abline
?read.table
?dnbinom
?write.table
?plot
?hist
?rgb
?dbeta
devtools::document()
devtools::document()
?rgb
devtools::document()
devtools::document()
?density
devtools::document()
devtools::document()
aneuploidy_vcf = system.file("extdata","aneuploidy.vcf.gz",package="MADSEQ")
target = system.file("extdata","target.bed",package="MADSEQ")
aneuploidy_hetero = prepareHetero(aneuploidy_vcf, target, writeToFile=FALSE)
aneuploidy_bam = system.file("extdata","aneuploidy.bam",package="MADSEQ")
normal_bam = system.file("extdata","normal.bam",package="MADSEQ")
aneuploidy_cov_gc = prepareCoverageGC(target,aneuploidy_bam,"hg19")
normal_cov_gc = prepareCoverageGC(target,normal_bam,"hg19")
normed = normalizeCoverage(aneuploidy_cov_gc,
control=normal_cov_gc,writeToFile=FALSE)
aneuploidy_normed_cov = normed[["aneuploidy_cov_gc"]]
aneuploidy_chr18 = runMadSeq(aneuploidy_hetero, aneuploidy_normed_cov,
#'                              target_chr="chr18", adapt=1000, burnin=1000,
#'                              nChain =1, nStep = 2000, thinSteps=1)
)
aneuploidy_chr18 = runMadSeq(aneuploidy_hetero, aneuploidy_normed_cov,target_chr="chr18", adapt=1000, burnin=1000,nChain =1, nStep = 2000, thinSteps=1)
?assign
?mem_change
library(pryr)
install.packages("pryr")
library(pryr)
mem_change(aneuploidy_chr18 = runMadSeq(aneuploidy_hetero, aneuploidy_normed_cov,target_chr="chr18", adapt=1000, burnin=1000,nChain =1, nStep = 2000, thinSteps=1))
mem_change(runMadSeq(aneuploidy_hetero, aneuploidy_normed_cov,target_chr="chr18", adapt=1000, burnin=1000,nChain =1, nStep = 2000, thinSteps=1))
aneuploidy_chr18
plotFraction(aneuploidy_chr18)
?mem_change
mem_used()
mem_change(runMadSeq(aneuploidy_hetero, aneuploidy_normed_cov,target_chr="chr18", adapt=5000, burnin=5000,nChain =1, nStep = 5000, thinSteps=1))
?Rprof
Rprof(tf <- "rprof.log", memory.profiling=TRUE)
runMadSeq(aneuploidy_hetero, aneuploidy_normed_cov,target_chr="chr18", adapt=5000, burnin=5000,nChain =1, nStep = 5000, thinSteps=1)
Rprof(NULL)
summaryRprof(tf)
Rprof(NULL)
runMadSeq(aneuploidy_hetero, aneuploidy_normed_cov,target_chr="chr18", adapt=5000, burnin=5000,nChain =1, nStep = 10000, thinSteps=1)
runMadSeq(aneuploidy_hetero, aneuploidy_normed_cov,target_chr="chr18", adapt=5000, burnin=5000,nChain =1, nStep = 10000, thinSteps=1)
devtools::document()
devtools::document()
aneuploidy_chr18 = runMadSeq(aneuploidy_hetero, aneuploidy_normed_cov,
target_chr="chr18", adapt=100, burnin=200,
nChain =1, nStep = 500, thinSteps=1)
plotFraction(aneuploidy_chr18)
devtools::document()
devtools::document()
devtools::document()
R.Version()
R.Version()$arch
?grep
grep(86,R.Version()$arch)
grep(6,R.Version()$arch)
grep(26,R.Version()$arch)
grep(26,R.Version()$arch,value=T)
grep(86,R.Version()$arch,value=T)
grep(26,R.Version()$arch,value=T)==0
grep(26,R.Version()$arch,value=T)==""
grep(26,R.Version()$arch,value=T)
a=grep(26,R.Version()$arch,value=T)
a
is.null(a)
length(a)
a=grep(26,R.Version()$arch)
a
a==0
length(grep("i386",R.Version()$arch))
length(grep("86",R.Version()$arch))
length(grep("86_64",R.Version()$arch))
devtools::document()
devtools::document()
head(aneuploidy_vcf)
loci = read.table("/Volumes/data/Project/Aneuploidy/Loci_1000g/loci/new03152016/ALL.recommendation.final.bed",sep="\t",header=F)
head(loci)
loci = read.table("/Volumes/data/Project/Aneuploidy/Loci_1000g/loci/new03152016/ALL.recommendation.final.txt,sep="\t",header=F)
loci = read.table("/Volumes/data/Project/Aneuploidy/Loci_1000g/loci/new03152016/ALL.recommendation.final.pos,sep="\t",header=F)
loci = read.table("/Volumes/data/Project/Aneuploidy/Loci_1000g/loci/new03152016/ALL.recommendation.final.pos",sep="\t",header=F)
head(loci)
library("quantsmooth")
?prepareGenomePlot
genome = data.frame(CHR=loci[,1],MapInfo=loci[,2])
par(mfrow=c(1,1), mar=c(1,5,1,1) )
chrompos = prepareGenomePlot(genome, paintCytobands=TRUE, organism="hsa",units="hg19")
points(chrompos[,2], jitter(chrompos[,1]+0.3,factor=0.5), pch=".", col="cornflowerblue", lwd=1 )
save(loci,"~/Desktop/example_loci.RData")
save(loci,file="~/Desktop/example_loci.RData")
